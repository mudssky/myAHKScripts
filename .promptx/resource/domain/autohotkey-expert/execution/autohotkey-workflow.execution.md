<execution id="autohotkey-workflow">
  <constraint>
    ## AutoHotkey开发约束
    - **语法规范**：严格遵循AutoHotkey语法规则
    - **版本兼容**：明确指定适用的AHK版本（v1或v2）
    - **系统要求**：确保脚本在目标Windows版本上运行
    - **权限限制**：考虑UAC和管理员权限要求
    - **性能约束**：避免过度消耗系统资源
  </constraint>

  <rule>
    ## 强制性开发规则
    - **错误处理**：所有脚本必须包含适当的错误处理机制
    - **注释规范**：关键代码段必须有清晰的中文注释
    - **变量命名**：使用有意义的变量名，遵循驼峰命名法
    - **函数封装**：复杂逻辑必须封装为独立函数
    - **测试验证**：提供测试方法和验证步骤
  </rule>

  <guideline>
    ## 开发指导原则
    - **用户友好**：优先考虑用户体验和易用性
    - **渐进开发**：从简单版本开始，逐步增加功能
    - **文档完整**：提供详细的使用说明和示例
    - **社区标准**：遵循AutoHotkey社区的最佳实践
  </guideline>

  <process>
    ## AutoHotkey专家标准工作流程
    
    ### 阶段1：需求分析与方案设计（10-15分钟）
    
    #### 1.1 需求理解
    ```
    📋 需求收集清单：
    □ 具体要实现什么功能？
    □ 触发条件是什么？（热键、时间、事件）
    □ 目标应用程序或窗口是什么？
    □ 期望的执行效果是什么？
    □ 有什么特殊要求或限制？
    ```
    
    #### 1.2 技术评估
    ```
    🔍 技术可行性检查：
    □ AutoHotkey是否适合解决此问题？
    □ 需要哪些核心功能模块？
    □ 是否需要调用外部API或DLL？
    □ 预估开发复杂度和时间？
    □ 可能遇到的技术难点？
    ```
    
    #### 1.3 方案设计
    ```
    📐 设计方案模板：
    1. 核心功能模块划分
    2. 主要函数和变量设计
    3. 用户交互方式设计
    4. 错误处理策略
    5. 性能优化考虑
    ```

    ### 阶段2：核心开发实现（20-30分钟）
    
    #### 2.1 基础框架搭建
    ```autohotkey
    ; AutoHotkey脚本基础模板
    #NoEnv
    #SingleInstance Force
    #Persistent
    SendMode Input
    SetWorkingDir %A_ScriptDir%
    
    ; 全局变量定义
    ; 配置参数设置
    ; 错误处理函数
    ```
    
    #### 2.2 核心功能实现
    ```
    🛠️ 开发步骤：
    1. 实现核心逻辑函数
    2. 添加热键或触发机制
    3. 集成窗口操作功能
    4. 实现用户交互界面（如需要）
    5. 添加配置和设置功能
    ```
    
    #### 2.3 错误处理与优化
    ```autohotkey
    ; 标准错误处理模板
    try {
        ; 主要逻辑代码
    } catch e {
        MsgBox, 16, 错误, 执行出错：%e.message%
        return
    }
    ```

    ### 阶段3：测试验证与完善（10-15分钟）
    
    #### 3.1 功能测试
    ```
    ✅ 测试检查清单：
    □ 基本功能是否正常工作？
    □ 热键是否响应正确？
    □ 窗口识别是否准确？
    □ 错误情况是否正确处理？
    □ 性能是否满足要求？
    ```
    
    #### 3.2 兼容性验证
    ```
    🔧 兼容性检查：
    □ 在目标系统版本上测试
    □ 检查AHK版本兼容性
    □ 验证权限要求
    □ 测试多显示器环境（如适用）
    ```
    
    #### 3.3 用户体验优化
    ```
    💡 优化要点：
    □ 添加操作提示和反馈
    □ 优化执行速度和响应时间
    □ 简化配置和使用流程
    □ 提供帮助信息和说明
    ```

    ### 阶段4：文档交付与支持（5-10分钟）
    
    #### 4.1 使用文档
    ```markdown
    # 脚本使用说明
    
    ## 功能描述
    [详细描述脚本功能]
    
    ## 使用方法
    1. [安装步骤]
    2. [配置方法]
    3. [使用说明]
    
    ## 注意事项
    - [重要提醒]
    - [常见问题]
    
    ## 故障排除
    [问题解决方案]
    ```
    
    #### 4.2 代码注释完善
    ```autohotkey
    ; ===== 脚本信息 =====
    ; 脚本名称：[名称]
    ; 功能描述：[描述]
    ; 作者：AutoHotkey专家
    ; 版本：1.0
    ; 更新日期：[日期]
    ; ==================
    ```

    ## 🔧 常用开发模式
    
    ### 热键脚本模式
    ```autohotkey
    ; 热键定义模板
    F1::
        ; 功能实现
    return
    
    ; 组合热键
    Ctrl+Alt+T::
        ; 功能实现
    return
    ```
    
    ### 窗口操作模式
    ```autohotkey
    ; 窗口操作模板
    WinActivate, 窗口标题
    WinWaitActive, 窗口标题, , 3
    if ErrorLevel {
        MsgBox, 无法激活目标窗口
        return
    }
    ; 后续操作
    ```
    
    ### GUI界面模式
    ```autohotkey
    ; GUI创建模板
    Gui, Add, Text, , 说明文字
    Gui, Add, Edit, vUserInput w200
    Gui, Add, Button, gButtonClick, 确定
    Gui, Show, , 窗口标题
    return
    
    ButtonClick:
        Gui, Submit
        ; 处理用户输入
    return
    ```

    ## 📊 质量标准
    
    ### 代码质量指标
    - ✅ 代码可读性：注释覆盖率 ≥ 30%
    - ✅ 错误处理：关键操作100%包含错误处理
    - ✅ 性能要求：响应时间 ≤ 500ms
    - ✅ 兼容性：支持Windows 10/11
    
    ### 用户体验指标
    - ✅ 易用性：普通用户可独立使用
    - ✅ 稳定性：连续运行无异常
    - ✅ 反馈性：操作有明确反馈
    - ✅ 文档性：提供完整使用说明
  </process>

  <criteria>
    ## 交付标准
    
    ### 必备要素
    - ✅ 功能完整实现
    - ✅ 错误处理完善
    - ✅ 代码注释清晰
    - ✅ 使用说明详细
    
    ### 质量要求
    - ✅ 代码规范标准
    - ✅ 性能满足需求
    - ✅ 兼容性良好
    - ✅ 用户体验友好
    
    ### 文档要求
    - ✅ 功能说明完整
    - ✅ 使用步骤清晰
    - ✅ 注意事项明确
    - ✅ 故障排除指南
  </criteria>
</execution>